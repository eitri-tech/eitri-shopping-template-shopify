fragment ProductFields on Product {
    category {
        id
        name
    }
    handle
    id
    images(first: 10) {
        nodes {
            url
            height
            width
            thumbhash
            id
        }
    }
    priceRange {
        minVariantPrice {
            amount
            currencyCode
        }
        maxVariantPrice {
            amount
            currencyCode
        }
    }
    isGiftCard
    title
    options {
        name
        id
        optionValues {
            id
            name
        }
    }
    variants(first: 50) {
        nodes {
            availableForSale
            barcode
            selectedOptions {
                name
                value
            }
            compareAtPrice {
                amount
                currencyCode
            }
            id
            image {
                altText
                height
                id
                url
                width
                thumbhash
            }
            price {
                amount
                currencyCode
            }
            sku
            title
        }
    }
    selectedOrFirstAvailableVariant {
        selectedOptions {
            name
            value
        }
    }
}

query SEARCH_QUERY(
    $query: String!
    $after: String
    $before: String
    $first: Int
    $last: Int
    $prefix: SearchPrefixQueryType
    $productFilters: [ProductFilter!]
    $reverse: Boolean
    $sortKey: SearchSortKeys
    $types: [SearchType!]
    $unavailableProducts: SearchUnavailableProductsType
) {
    search(
        query: $query
        after: $after
        before: $before
        first: $first
        last: $last
        prefix: $prefix
        productFilters: $productFilters
        reverse: $reverse
        sortKey: $sortKey
        types: $types
        unavailableProducts: $unavailableProducts
    ) {
        totalCount
        nodes {
            ... on Product {
                ...ProductFields
            }
        }
    }
}

query COLLECTION_QUERY(
    $collectionId: ID
    $handle: String
    $after: String
    $before: String
    $first: Int
    $last: Int
    $reverse: Boolean
    $sortKey: ProductCollectionSortKeys
) {
    collection(
        id: $collectionId
        handle: $handle
    ) {
        id
        title
        description
        handle
        image {
            url
            height
            width
            id
        }
        trackingParameters,
        products (first: $first, last:$last, after: $after, before: $before, reverse: $reverse, sortKey: $sortKey) {
            nodes {
                ... on Product {
                    ...ProductFields
                }
            }
        }
    }
}